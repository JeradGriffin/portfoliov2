<section class="portfolio" id="portfolio">
    <h2>Work</h2>
    <div class="portfolio-container">
        <!-- Portfolio cards will be injected here by JavaScript -->
    </div>
</section>

<style webc:scoped>
    h2 {
        margin-block-end: var(--spacing--small, 1rem);
    }

    .portfolio {
        container-type: inline-size;
        container-name: portfolio;
    }
    
    .portfolio-container {
        display: grid;
        gap: 1rem;
        grid-template-columns: 1fr;
    }

    .portfolio-card {
        background-color: var(--card-bg, oklch(97.015% 0.00011 271.152));
        border-radius: var(--border-radius-8, 0.5rem);
        overflow: hidden;
        padding: var(--spacing--small);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        &:hover {
            box-shadow: 0 1px 8px rgba(0, 0, 0, 0.2);
        }
        &:hover img {
            transform: scale(1.08);
        }
        a {
            text-decoration: none;
            color: inherit;
            display: grid;
            gap: var(--spacing--small);
            .card-image {
                border-radius: var(--border-radius-8);
                display: flex;
                height: auto;
                /* min-height: 14.688rem;
                max-height: 14.688rem; */
                overflow: hidden;
                min-width: 100%;

                img {
                    transition: transform 0.3s ease;
                }
            }

            h3, p {
                color: var(--color--primary, oklch(35.618% 0.00004 271.152));
            }

            h3 {
                font-size: var(--h3-size, 1.25rem);
                font-weight: var(--font--bold);
                margin-block-end: var(--spacing--xx-small);
            }

            p {
                font-weight: normal;
            }
        }
    }

    @container portfolio (min-width: 768px) {
        .portfolio-container {
            grid-template-columns: 1fr 1fr;
        }
    }

    @container portfolio (min-width: 1024px) {
        .portfolio-container {
            grid-template-columns: repeat(4, 1fr);
        }
    }
</style>

<script>
    const portfolioData = [
        {
            name: "Kraft",
            description: "Development",
            imageUrl: "/portfolio/images/kraft.png",
            pageUrl: "/pages/fn-site-portfolio-page"
        },
        {
            name: "FCSA",
            description: "Custom Component Development",
            imageUrl: "/portfolio/images/fcsa.png",
            pageUrl: "/pages/fn-site-portfolio-page"
        },
        {
            name: "Chubb",
            description: "Development",
            imageUrl: "/portfolio/images/chubb.png",
            pageUrl: "/pages/fn-site-portfolio-page"
        },
        {
            name: "Cornerstone",
            description: "Design and Development",
            imageUrl: "/portfolio/images/csod.png",
            pageUrl: "/pages/fn-site-portfolio-page"
        }
    ];

    const container = document.querySelector('.portfolio-container');   
    portfolioData.forEach(item => {
        const card = document.createElement('div');
        card.classList.add('portfolio-card');
        card.innerHTML = `
            <a href="${item.pageUrl}">
                <div class="card-image">
                    <img src="${item.imageUrl}" alt="${item.name}">
                </div>
                <div class="card-description">
                    <h3>${item.name}</h3>
                    <p>${item.description}</p>
                </div>
            </a>
        `;
        container.appendChild(card);
    });

    // Add class names to portfolio cards based on their headings
    document.querySelectorAll('.portfolio-card').forEach(card => {
        const h3 = card.querySelector('h3');
        const name = h3.textContent.trim().replace(/\s+/g, '-').toLowerCase();
        card.classList.add(name);

        const link = card.querySelector('a');
        if (link) {
            const baseHref = link.getAttribute('href').split('?')[0];
            link.setAttribute('href', `${baseHref}?card=${name}`);
        }

        link.addEventListener('click', function() {
            sessionStorage.setItem('portfolioCardUrl', link.href);
        });
    });
</script>